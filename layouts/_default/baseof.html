<!DOCTYPE html>
<html lang="{{ $.Site.LanguageCode }}">
  <head>
    <link rel="preload" href="/assets/fonts/NeueMachina-Regular.woff2" as="font" crossorigin type="font/woff2">
    <link rel="preload" href="/assets/fonts/NeueMachina-Ultrabold.woff2" as="font" crossorigin type="font/woff2">
    <meta charset="utf-8">
    <meta name="language" content="{{ .Site.LanguageCode }}" />
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <title>{{ block "title" . }}{{ .Site.Title }}{{ with .Params.Title }} | {{ . }}{{ end }}{{ end }}</title>
    <meta name="author" content='{{ .Site.Params.Author }}' />
    <meta name="description" content='{{ .Site.Params.Description }}' />
    <meta property="og:type" content="website" />
  	<meta property="og:url" content="{{ .Permalink }}" />
    <meta property="og:title" content="{{ .Site.Title }} {{ with .Params.Title }} | {{ . }}{{ end }}" />
    <meta property="og:description" content='{{ .Site.Params.Description }}' />
    <meta property="og:image" content="{{ .Site.BaseURL }}assets/img/garages-numeriques-opengraph.jpg" />
    <meta property="og:site_name" content="{{ .Site.Title }}" />
    {{ $style := resources.Get "sass/main.scss" | resources.ToCSS | resources.PostCSS | resources.Minify | resources.Fingerprint }}
    <link rel="stylesheet" type="text/css" href="{{ $style.Permalink | relURL }}">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
	  <!-- Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '2991615814243709');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=2991615814243709&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->
  </head>
	<body id="root" class="{{ .Params.layout }}">
    <div class="site-wrapper">
      {{ block "header" . }}{{ partial "site-header.html" .}}{{ end }}
      <main class="site-main {{ if ne .IsHome true }}main-single{{ else }}main-home{{ end }}" id="site-main">{{ block "main" . }}{{ end }}</main>
      {{ block "footer" . }}{{ partial "site-footer.html" . }}{{ end }}
    </div>
    
    <script>
        window.onload = function() {
          // VIDEO BG
          /*var min = 1,
                max = 5,
                random = Math.floor(Math.random() * (+max - +min)) + +min; */
            
          var videlem = document.createElement("video"),
              sourceMP4 = document.createElement("source"),
              supportsVideoElement = !!document.createElement('video').canPlayType,
              temp = document.createElement('video'),
              canPlay_MP4 = temp.canPlayType('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),
              //canPlay_WEMB = temp.canPlayType('video/webm; codecs="vp8,vorbis"'),
              videoWrapper = document.getElementById('video-wrapper');
          
          if (supportsVideoElement && canPlay_MP4) {
            videlem.id = "video-bg";    
            sourceMP4.type = "video/mp4";
            sourceMP4.src = "/assets/videos/garages-numeriques-homepage-loop.mp4";
            videlem.appendChild(sourceMP4);
            videlem.preload = true;
            videlem.autoplay = true;
            videlem.muted = true;
            videlem.loop = true;
            videlem.setAttribute('playsinline', '');
            videoWrapper.appendChild(videlem);
            videlem.onloadeddata = function() {
              logoAnim(launchGlitch);
            }; 
          } else {
            logoAnim(launchGlitch);
        
          }
        
          // LOGO ANIM
          var logoAnim = function(callback) {
            var sixthBar = document.getElementById('sixth-bar'),
            isFirstAnimTerminated = false,
            siteLogoTextSpans = document.querySelectorAll('.site-logo__text__span'),
            siteLogoBars = document.querySelectorAll('.site-logo__bar');
        
            for (var i=0; i<siteLogoTextSpans.length; i++) {
              siteLogoTextSpans[i].classList.add('animated');
            }
            for (var i=0; i<siteLogoBars.length; i++) {
              siteLogoBars[i].classList.add('animated');
            }
        
            sixthBar.addEventListener("webkitAnimationEnd", launchBlueBar);
            sixthBar.addEventListener("animationend", launchBlueBar); 
        
            function launchBlueBar() {
              if (!isFirstAnimTerminated) {
                sixthBar.classList.add('bluebar');
              }
            }
        
            setTimeout( function(){
              callback();
            }, 3000 );
          }
        
          // GLITCH
          function launchGlitch() {
            var homeTitle = document.getElementById('home-title__h1');
            homeTitle.classList.add('glitch');
          }
        
          // AGENDA
          var discoverBtn = document.getElementById('discover-btn'),
          agendaSection = document.getElementById('home-agenda'),
          agendaCloseBtn = document.getElementById('home-agenda__close-btn');

          discoverBtn.addEventListener('click', function() {
            agendaSection.classList.add('open');
          })

          agendaCloseBtn.addEventListener('click', function() {
            agendaSection.classList.remove('open');
          })
        }
    </script>
  </body>
</html>
